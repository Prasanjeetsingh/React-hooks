(this["webpackJsonpdemo-app"]=this["webpackJsonpdemo-app"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),i=n(7),a=n.n(i),s=n(2),o=n(0),d=c.a.createContext({isAuth:!1,login:function(){}}),l=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),c=n[0],i=n[1];return Object(o.jsx)(d.Provider,{value:{login:function(){i(!0)},isAuth:c},children:e.children})},u=(n(14),n(4)),j=n(8),b=(n(15),function(e){return Object(o.jsx)("div",{className:"card",children:e.children})}),O=(n(16),n(17),function(){return Object(o.jsxs)("div",{className:"lds-ring",children:[Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{})]})}),f=c.a.memo((function(e){var t=Object(r.useState)(""),n=Object(s.a)(t,2),c=n[0],i=n[1],a=Object(r.useState)(""),d=Object(s.a)(a,2),l=d[0],u=d[1];return Object(o.jsx)("section",{className:"ingredient-form",children:Object(o.jsx)(b,{children:Object(o.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onAddIngredient({title:c,amount:l})},children:[Object(o.jsxs)("div",{className:"form-control",children:[Object(o.jsx)("label",{htmlFor:"title",children:"Name"}),Object(o.jsx)("input",{type:"text",id:"title",value:c,onChange:function(e){i(e.target.value)}})]}),Object(o.jsxs)("div",{className:"form-control",children:[Object(o.jsx)("label",{htmlFor:"amount",children:"Amount"}),Object(o.jsx)("input",{type:"number",id:"amount",value:l,onChange:function(e){u(e.target.value)}})]}),Object(o.jsxs)("div",{className:"ingredient-form__actions",children:[Object(o.jsx)("button",{type:"submit",children:"Add Ingredient"}),e.loading&&Object(o.jsx)(O,{})]})]})})})})),h=(n(18),c.a.memo((function(e){return Object(o.jsxs)("section",{className:"ingredient-list",children:[Object(o.jsx)("h2",{children:"Loaded Ingredients"}),Object(o.jsx)("ul",{children:e.ingredients.map((function(t){return Object(o.jsxs)("li",{onClick:e.onRemoveItem.bind(undefined,t.id),children:[Object(o.jsx)("span",{children:t.title}),Object(o.jsxs)("span",{children:[t.amount,"x"]})]},t.id)}))})]})}))),x=(n(19),c.a.memo((function(e){return Object(o.jsxs)(c.a.Fragment,{children:[Object(o.jsx)("div",{className:"backdrop",onClick:e.onClose}),Object(o.jsxs)("div",{className:"error-modal",children:[Object(o.jsx)("h2",{children:"An Error Occurred!"}),Object(o.jsx)("p",{children:e.children}),Object(o.jsx)("div",{className:"error-modal__actions",children:Object(o.jsx)("button",{type:"button",onClick:e.onClose,children:"Okay"})})]})]})}))),m=(n(20),{loading:!1,error:null,data:null,extra:null,identifier:null}),g=function(e,t){switch(t.type){case"SEND":return{loading:!0,error:null,data:null,extra:null,identifier:t.identifier};case"RESPONSE":return Object(u.a)(Object(u.a)({},e),{},{loading:!1,data:t.responseData,extra:t.extra});case"ERROR":return{loading:!1,error:t.errorMessage};case"CLEAR":return m;default:throw new Error("Should not be reached!")}},p=function(){var e=Object(r.useReducer)(g,{loading:!1,error:null,data:null,extra:null,identifier:null}),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(r.useCallback)((function(){return c({type:"CLEAR"})}),[]),a=Object(r.useCallback)((function(e,t,n,r,i){c({type:"SEND",identifier:i}),fetch(e,{method:t,body:n,headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){c({type:"RESPONSE",responseData:e,extra:r})})).catch((function(e){c({type:"ERROR",errorMessage:"Something went wrong!"})}))}),[]);return{isLoading:n.loading,data:n.data,error:n.error,sendRequest:a,reqExtra:n.extra,reqIdentifier:n.identifier,clear:i}},E=c.a.memo((function(e){var t=Object(r.useRef)(),n=e.onLoadIngredients,c=Object(r.useState)(""),i=Object(s.a)(c,2),a=i[0],d=i[1],l=p(),u=l.isLoading,j=l.error,O=l.data,f=l.sendRequest,h=l.clear;return Object(r.useEffect)((function(){if(!u&&!j&&O){var e=[];for(var t in O)e.push({id:t,title:O[t].title,amount:O[t].amount});n(e)}}),[O,j,u,n]),Object(r.useEffect)((function(){var e=setTimeout((function(){if(a===t.current.value){var e=0===a.length?"":'?orderBy="title"&equalTo="'.concat(a,'"');f("https://react-hook-update-f2705-default-rtdb.firebaseio.com/ingredients.json"+e,"GET")}}),500);return function(){clearTimeout(e)}}),[a,f,t]),Object(o.jsxs)("section",{className:"search",children:[j&&Object(o.jsx)(x,{onClose:h,children:j}),Object(o.jsx)(b,{children:Object(o.jsxs)("div",{className:"search-input",children:[Object(o.jsx)("label",{children:"Filter by Title"}),u&&Object(o.jsx)("span",{children:"Loading... "}),Object(o.jsx)("input",{ref:t,type:"text",value:a,onChange:function(e){return d(e.target.value)}})]})})]})})),v=function(e,t){switch(t.type){case"SET":return t.ingredients;case"ADD":return[].concat(Object(j.a)(e),[t.ingredient]);case"DELETE":return e.filter((function(e){return e.id!==t.id}));default:throw new Error("Should nor get there!")}},N=function(e){var t=p(),n=t.isLoading,c=t.error,i=t.data,a=t.sendRequest,d=t.reqExtra,l=t.reqIdentifier,j=t.clear,b=Object(r.useReducer)(v,[]),O=Object(s.a)(b,2),m=O[0],g=O[1];Object(r.useEffect)((function(){n||c||"REMOVE_INGREDIENT"!==l?n||c||"ADD_INGREDIENT"!==l||g({type:"ADD",ingredient:Object(u.a)({id:i.name},d)}):g({type:"DELETE",id:d})}),[i,d,l,c,n]);var N=Object(r.useCallback)((function(e){g({type:"SET",ingredients:e})}),[]),R=Object(r.useCallback)((function(e){a("https://react-hook-update-f2705-default-rtdb.firebaseio.com/ingredients.json","POST",JSON.stringify(e),e,"ADD_INGREDIENT")}),[a]),C=Object(r.useCallback)((function(e){a("https://react-hook-update-f2705-default-rtdb.firebaseio.com/ingredients/".concat(e,".json"),"DELETE",null,e,"REMOVE_INGREDIENT")}),[a]),y=Object(r.useMemo)((function(){return Object(o.jsx)(h,{ingredients:m,onRemoveItem:C})}),[m,C]);return Object(o.jsxs)("div",{className:"App",children:[c&&Object(o.jsxs)(x,{onClose:j,children:[" ",c," "]}),Object(o.jsx)(f,{onAddIngredient:R,loading:n}),Object(o.jsxs)("section",{children:[Object(o.jsx)(E,{onLoadIngredients:N}),y]})]})},R=(n(21),function(e){var t=Object(r.useContext)(d);return Object(o.jsx)("div",{className:"auth",children:Object(o.jsxs)(b,{children:[Object(o.jsx)("h2",{children:"You are not authenticated!"}),Object(o.jsx)("p",{children:"Please log in to continue."}),Object(o.jsx)("button",{onClick:function(){t.login()},children:"Log In"})]})})}),C=function(e){var t=Object(r.useContext)(d),n=Object(o.jsx)(R,{});return t.isAuth&&(n=Object(o.jsx)(N,{})),n};a.a.render(Object(o.jsx)(l,{children:Object(o.jsx)(C,{})}),document.getElementById("root"))}],[[22,1,2]]]);
//# sourceMappingURL=main.8ac35a90.chunk.js.map